# Plan: Backend Engineering: 시스템 프롬프트 코드 관리 시스템 구축

## Task Information
- **Task ID**: 88d26681-c235-42ac-a718-af3cdfe29e46
- **Type**: team_epic
- **Created**: 2026-01-08T15:59:00.132Z

## Objective

현재 Hollon-AI 시스템에서 시스템 프롬프트가 시드 데이터(seed.ts)에 하드코딩되어 있어 유지보수가 어렵고 버전 관리가 불가능한 문제를 해결하기 위해, **코드 기반 프롬프트 템플릿 관리 시스템**을 구축합니다.

이 시스템은:
- Role별 시스템 프롬프트를 TypeScript 코드 템플릿으로 관리
- 코드 템플릿(기본값)과 DB 저장 프롬프트(커스텀)를 병합하는 메커니즘 제공
- 변수 치환, 버전 관리, 미리보기 기능 지원
- 기존 Role/Hollon 서비스와 매끄럽게 통합

## Analysis

### Current State Assessment

**문제점:**
1. **하드코딩된 프롬프트**: seed.ts에 모든 Role의 systemPrompt가 문자열로 하드코딩됨
2. **버전 관리 불가**: 프롬프트 변경 이력 추적이 어려움
3. **재사용성 부족**: 공통 패턴을 추출하여 재사용할 수 없음
4. **변수 치환 미지원**: 동적 변수 치환 메커니즘이 없음
5. **유지보수 어려움**: 프롬프트 수정 시 seed.ts를 직접 수정해야 함

**현재 아키텍처:**
- `Role` 엔티티: `systemPrompt: string` 필드 (nullable)
- `Hollon` 엔티티: `systemPrompt: string` 필드 (nullable, Role의 프롬프트를 오버라이드 가능)
- `RoleService`: Role CRUD 및 조회
- `HollonService`: Hollon 생성 시 Role의 systemPrompt 참조
- `seed.ts`: 모든 초기 Role 데이터에 systemPrompt 하드코딩

### Codebase Impact

**생성할 파일:**
```
apps/server/src/modules/prompt-templates/
├── prompt-template.module.ts
├── interfaces/
│   ├── prompt-template.interface.ts          # IPromptTemplate, IRoleTemplate, IPromptVariable
│   └── role-type.enum.ts                      # Role 타입 enum
├── templates/
│   └── roles/
│       ├── cto.template.ts                    # CTO 프롬프트 템플릿
│       ├── tech-lead.template.ts              # TechLead 프롬프트 템플릿
│       ├── ai-lead.template.ts                # AILead 프롬프트 템플릿
│       ├── infra-lead.template.ts             # InfraLead 프롬프트 템플릿
│       ├── backend-engineer.template.ts
│       ├── ml-engineer.template.ts
│       ├── data-engineer.template.ts
│       ├── junior-backend-engineer.template.ts
│       ├── planning-specialist.template.ts
│       ├── implementation-specialist.template.ts
│       ├── testing-specialist.template.ts
│       └── integration-specialist.template.ts
├── services/
│   ├── prompt-template-registry.service.ts    # 템플릿 중앙 관리
│   ├── prompt-merge.service.ts                # 코드 + DB 병합 로직
│   ├── prompt-version.service.ts              # 버전 관리
│   └── prompt-validation.service.ts           # 유효성 검증
├── dtos/
│   ├── create-prompt-template.dto.ts
│   ├── update-prompt-template.dto.ts
│   └── prompt-template-response.dto.ts
├── controllers/
│   └── prompt-template.controller.ts          # GET /prompt-templates/:role
└── README.md                                  # 모듈 사용법 문서
```

**수정할 파일:**
```
apps/server/src/app.module.ts                  # PromptTemplateModule import
apps/server/src/modules/role/role.service.ts   # PromptMergeService 통합
apps/server/src/modules/hollon/hollon.service.ts # PromptMergeService 통합
apps/server/src/database/seed.ts               # systemPrompt 필드 제거 또는 null로 변경
```

**테스트 파일:**
```
apps/server/src/modules/prompt-templates/services/
├── prompt-template-registry.service.spec.ts
├── prompt-merge.service.spec.ts
└── prompt-validation.service.spec.ts
apps/server/src/modules/prompt-templates/controllers/
└── prompt-template.controller.spec.ts
apps/server/test/
└── prompt-template-integration.e2e-spec.ts    # E2E 통합 테스트
```

**문서 파일:**
```
docs/prompt-template-system.md                 # 시스템 아키텍처 및 사용 가이드
docs/teams/backend-engineering/prompt-template-analysis.md # 프롬프트 분석 결과
```

### Dependencies Affected

**직접 의존성:**
- `@nestjs/common`: 모듈, 서비스, 컨트롤러 데코레이터
- `@nestjs/typeorm`: TypeORM 통합 (DB 우선순위 병합 시)
- `class-validator`: DTO 유효성 검증
- `class-transformer`: DTO 변환

**간접 영향:**
- `RoleModule`: PromptTemplateModule을 import해야 함
- `HollonModule`: PromptMergeService를 주입받아야 함
- Seed 스크립트: systemPrompt 제거 후 템플릿에서 가져오기

**새로운 의존성:**
- 없음 (기존 NestJS 스택으로 구현 가능)

### Technical Approach

#### 1. 아키텍처 설계

**3-Layer 아키텍처:**

```
┌─────────────────────────────────────────────────────────┐
│                  Application Layer                       │
│  (RoleService, HollonService)                           │
└────────────────────┬────────────────────────────────────┘
                     │
                     │ uses
                     ▼
┌─────────────────────────────────────────────────────────┐
│              Prompt Management Layer                     │
│  ┌─────────────────────────────────────────────────┐   │
│  │  PromptMergeService                              │   │
│  │  - mergePrompts(roleId, customPrompt?, vars?)   │   │
│  │  - 코드 템플릿 + DB 커스텀 병합                  │   │
│  └─────────────┬───────────────────────────────────┘   │
│                │                                         │
│                ├─► PromptTemplateRegistry               │
│                │   - getTemplateByRole(roleName)        │
│                │   - 템플릿 캐싱                         │
│                │                                         │
│                └─► PromptValidationService              │
│                    - validateTemplate(template)         │
└─────────────────────────────────────────────────────────┘
                     │
                     │ reads from
                     ▼
┌─────────────────────────────────────────────────────────┐
│              Template Storage Layer                      │
│  ┌──────────────────────────────────────────────────┐  │
│  │  Code Templates (TypeScript)                      │  │
│  │  - cto.template.ts                                │  │
│  │  - tech-lead.template.ts                          │  │
│  │  - ...                                            │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

**병합 우선순위 전략:**
```typescript
// Option 1: DB 우선 (커스텀 우선)
finalPrompt = dbPrompt ?? codeTemplate

// Option 2: 부분 병합 (섹션별 오버라이드)
finalPrompt = {
  intro: dbPrompt?.intro ?? codeTemplate.intro,
  responsibilities: dbPrompt?.responsibilities ?? codeTemplate.responsibilities,
  guidelines: dbPrompt?.guidelines ?? codeTemplate.guidelines,
}

// 추천: Option 1 (간단하고 명확)
```

#### 2. 템플릿 구조 설계

**인터페이스 정의:**
```typescript
// interfaces/prompt-template.interface.ts
export interface IPromptVariable {
  name: string;
  description: string;
  defaultValue?: string;
  required: boolean;
}

export interface IPromptTemplate {
  role: string;                    // Role 이름 (예: "TechnicalLead")
  version: string;                 // 템플릿 버전 (예: "1.0.0")
  template: string;                // 프롬프트 템플릿 (변수 포함: {{variableName}})
  variables: IPromptVariable[];    // 사용 가능한 변수 목록
  description?: string;            // 템플릿 설명
  createdAt: Date;
  updatedAt: Date;
}

export interface IRoleTemplate {
  getTemplate(): IPromptTemplate;
  substituteVariables(vars: Record<string, string>): string;
}
```

**템플릿 파일 예시:**
```typescript
// templates/roles/tech-lead.template.ts
import { IRoleTemplate, IPromptTemplate } from '../../interfaces/prompt-template.interface';

export class TechLeadTemplate implements IRoleTemplate {
  private readonly template: IPromptTemplate = {
    role: 'TechnicalLead',
    version: '1.0.0',
    template: `당신은 Technical Lead입니다.

당신의 임무:
- 시스템 아키텍처 설계 및 기술 의사결정
- Team Epic을 Implementation Tasks로 분해
- 팀원들에게 Task 효율적 분배 (capability 기반 매칭)
- 코드 리뷰 및 PR 승인
- 기술 블로커 해결 및 팀 조정

{{#if teamName}}
당신의 팀: {{teamName}}
{{/if}}

Task 분해 원칙:
- 각 Task는 PR 단위 (의미있는 코드 변경 포함)
- 단순 디렉토리/파일 생성 Task 지양
- 독립적으로 리뷰 가능한 단위
- Capability 기반 팀원 매칭

분배 원칙:
- requiredSkills와 Hollon capabilities 매칭
- 워크로드 밸런싱 고려
- 의존성 순서 파악 및 병렬화
- 협업 기회 활용`,
    variables: [
      {
        name: 'teamName',
        description: '팀 이름',
        required: false,
      },
      {
        name: 'organizationName',
        description: '조직 이름',
        required: false,
      },
    ],
    description: 'Technical Lead Role의 시스템 프롬프트',
    createdAt: new Date(),
    updatedAt: new Date(),
  };

  getTemplate(): IPromptTemplate {
    return this.template;
  }

  substituteVariables(vars: Record<string, string>): string {
    let result = this.template.template;
    
    // 간단한 변수 치환 ({{variableName}} → value)
    for (const [key, value] of Object.entries(vars)) {
      const regex = new RegExp(`\\{\\{${key}\\}\\}`, 'g');
      result = result.replace(regex, value);
    }
    
    // 조건부 블록 처리 ({{#if variable}}...{{/if}})
    result = this.processConditionals(result, vars);
    
    return result;
  }

  private processConditionals(template: string, vars: Record<string, string>): string {
    // {{#if variable}}...{{/if}} 패턴 처리
    const ifRegex = /\{\{#if (\w+)\}\}([\s\S]*?)\{\{\/if\}\}/g;
    return template.replace(ifRegex, (match, varName, content) => {
      return vars[varName] ? content : '';
    });
  }
}
```

#### 3. 서비스 구현 전략

**PromptTemplateRegistry (템플릿 중앙 관리):**
```typescript
@Injectable()
export class PromptTemplateRegistry {
  private readonly templates = new Map<string, IRoleTemplate>();
  private readonly cache = new Map<string, IPromptTemplate>();

  constructor() {
    // 모든 템플릿 등록
    this.registerTemplate('TechnicalLead', new TechLeadTemplate());
    this.registerTemplate('CTO', new CTOTemplate());
    // ... 나머지 Role 템플릿
  }

  registerTemplate(roleName: string, template: IRoleTemplate): void {
    this.templates.set(roleName, template);
  }

  getTemplateByRole(roleName: string): IPromptTemplate | null {
    // 캐시 확인
    if (this.cache.has(roleName)) {
      return this.cache.get(roleName);
    }

    // 템플릿 조회
    const template = this.templates.get(roleName);
    if (!template) {
      return null;
    }

    const promptTemplate = template.getTemplate();
    this.cache.set(roleName, promptTemplate);
    return promptTemplate;
  }

  substituteVariables(roleName: string, vars: Record<string, string>): string | null {
    const template = this.templates.get(roleName);
    if (!template) {
      return null;
    }
    return template.substituteVariables(vars);
  }
}
```

**PromptMergeService (병합 로직):**
```typescript
@Injectable()
export class PromptMergeService {
  constructor(
    private readonly registry: PromptTemplateRegistry,
    @InjectRepository(Role) private readonly roleRepo: Repository<Role>,
  ) {}

  /**
   * Role의 최종 시스템 프롬프트를 반환
   * 우선순위: DB 커스텀 프롬프트 > 코드 템플릿
   */
  async getFinalPrompt(
    roleId: string,
    variables?: Record<string, string>,
  ): Promise<string> {
    // 1. Role 조회
    const role = await this.roleRepo.findOne({ where: { id: roleId } });
    if (!role) {
      throw new NotFoundException(`Role #${roleId} not found`);
    }

    // 2. DB에 커스텀 프롬프트가 있으면 우선 사용
    if (role.systemPrompt) {
      return this.substituteVariablesInString(role.systemPrompt, variables);
    }

    // 3. 코드 템플릿에서 가져오기
    const templatePrompt = this.registry.substituteVariables(
      role.name,
      variables || {},
    );
    
    if (!templatePrompt) {
      throw new NotFoundException(
        `No template found for role: ${role.name}`,
      );
    }

    return templatePrompt;
  }

  /**
   * Hollon의 최종 시스템 프롬프트를 반환
   * 우선순위: Hollon 커스텀 > Role DB > Role 템플릿
   */
  async getFinalPromptForHollon(
    hollonId: string,
    variables?: Record<string, string>,
  ): Promise<string> {
    const hollon = await this.hollonRepo.findOne({
      where: { id: hollonId },
      relations: ['role'],
    });
    
    if (!hollon) {
      throw new NotFoundException(`Hollon #${hollonId} not found`);
    }

    // 1. Hollon 자체 커스텀 프롬프트 우선
    if (hollon.systemPrompt) {
      return this.substituteVariablesInString(hollon.systemPrompt, variables);
    }

    // 2. Role의 프롬프트 사용
    return this.getFinalPrompt(hollon.roleId, variables);
  }

  private substituteVariablesInString(
    template: string,
    variables?: Record<string, string>,
  ): string {
    if (!variables) return template;

    let result = template;
    for (const [key, value] of Object.entries(variables)) {
      const regex = new RegExp(`\\{\\{${key}\\}\\}`, 'g');
      result = result.replace(regex, value);
    }
    return result;
  }
}
```

#### 4. 통합 전략

**RoleService 수정:**
```typescript
// role.service.ts
@Injectable()
export class RoleService {
  constructor(
    @InjectRepository(Role) private roleRepo: Repository<Role>,
    private readonly promptMergeService: PromptMergeService, // 추가
  ) {}

  async findOne(id: string): Promise<Role> {
    const role = await this.roleRepo.findOne({ where: { id } });
    if (!role) {
      throw new NotFoundException(`Role #${id} not found`);
    }
    return role;
  }

  // 새 메서드 추가
  async getSystemPrompt(id: string, variables?: Record<string, string>): Promise<string> {
    return this.promptMergeService.getFinalPrompt(id, variables);
  }
}
```

**HollonService 수정:**
```typescript
// hollon.service.ts
@Injectable()
export class HollonService {
  constructor(
    // ... 기존 의존성
    private readonly promptMergeService: PromptMergeService, // 추가
  ) {}

  async create(dto: CreateHollonDto): Promise<Hollon> {
    // Hollon 생성 시 systemPrompt는 null로 설정 (템플릿에서 가져옴)
    const hollon = this.hollonRepo.create({
      ...dto,
      systemPrompt: dto.systemPrompt || null, // 커스텀이 없으면 null
    });
    
    return this.hollonRepo.save(hollon);
  }

  // 새 메서드 추가
  async getSystemPrompt(hollonId: string): Promise<string> {
    return this.promptMergeService.getFinalPromptForHollon(hollonId);
  }
}
```

#### 5. 시드 데이터 마이그레이션

**Before (현재):**
```typescript
// seed.ts
const techLeadRole = roleRepo.create({
  name: 'TechnicalLead',
  systemPrompt: `당신은 Technical Lead입니다...`, // 하드코딩
});
```

**After (변경 후):**
```typescript
// seed.ts
const techLeadRole = roleRepo.create({
  name: 'TechnicalLead',
  systemPrompt: null, // 코드 템플릿에서 가져오도록 null 설정
  // 또는 완전히 제거
});
```

**마이그레이션 전략:**
- DB 스키마 변경 불필요 (systemPrompt 필드는 nullable)
- seed.ts에서 systemPrompt를 null로 변경하거나 제거
- 기존 DB 데이터는 그대로 유지 (커스텀으로 취급)

### Risks and Mitigations

| Risk | Mitigation |
|------|------------|
| **템플릿과 DB 데이터 불일치** | - PromptValidationService로 템플릿 구조 검증<br>- 마이그레이션 스크립트로 기존 데이터 검증<br>- 단위 테스트에서 모든 Role 템플릿 검증 |
| **성능 저하 (템플릿 조회 오버헤드)** | - PromptTemplateRegistry에 메모리 캐싱 구현<br>- 변수 치환 결과 캐싱 (동일 변수 세트에 대해)<br>- 벤치마크 테스트로 성능 측정 |
| **변수 치환 오류** | - 변수 치환 전 필수 변수 검증<br>- 명확한 에러 메시지 제공<br>- 미리보기 API로 치환 결과 사전 확인 |
| **기존 기능 파손** | - 통합 테스트로 Role/Hollon 생성 플로우 검증<br>- E2E 테스트로 전체 워크플로우 검증<br>- Seed 실행 후 데이터 검증 |
| **Role 템플릿 누락** | - 모든 Role에 대한 템플릿 파일 생성<br>- PromptTemplateRegistry 초기화 시 템플릿 존재 여부 검증<br>- 누락된 템플릿 발견 시 명확한 에러 |
| **버전 관리 복잡도** | - Phase 1에서는 버전 관리 최소화 (단순 버전 필드만)<br>- Phase 2에서 필요시 별도 버전 히스토리 테이블 추가 |

## Decomposition

### Implementation Phases

이 Team Epic은 **4개의 Phase**로 분해하며, 각 Phase는 독립적으로 테스트 및 배포 가능합니다.

#### **Phase 1: Core Infrastructure (P1 - Highest Priority)**
기반 인프라 구축 - 모듈 구조, 인터페이스, 서비스

#### **Phase 2: Template Implementation (P2)**
Role별 템플릿 구현 및 서비스 통합

#### **Phase 3: Testing & Integration (P2)**
테스트 작성 및 기존 서비스 통합

#### **Phase 4: Advanced Features (P3-P4)**
버전 관리, 캐싱, 모니터링 등 고급 기능

---

### Subtasks

#### **Phase 1: Core Infrastructure Setup**

##### 1.1 프롬프트 템플릿 모듈 디렉토리 구조 설계 및 생성
- **Assignee recommendation**: Backend Engineer (TypeScript, NestJS 경험)
- **Priority**: P1
- **Estimated effort**: 1-2 hours
- **Description**:
  - `apps/server/src/modules/prompt-templates/` 디렉토리 생성
  - 하위 디렉토리 구조 생성: `templates/`, `services/`, `dtos/`, `interfaces/`, `controllers/`
  - `templates/roles/` 디렉토리 생성 (Role 템플릿 저장소)
  - `README.md` 파일 생성 및 모듈 개요 작성
- **Acceptance Criteria**:
  - [ ] `apps/server/src/modules/prompt-templates/` 디렉토리 존재
  - [ ] 모든 하위 디렉토리 존재 (`templates/roles/`, `services/`, `dtos/`, `interfaces/`, `controllers/`)
  - [ ] `README.md`에 모듈 구조, 사용 목적, 기본 사용법 문서화
  - [ ] Git 커밋: `feat: Create prompt-templates module directory structure`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/.gitkeep`
  - `apps/server/src/modules/prompt-templates/services/.gitkeep`
  - `apps/server/src/modules/prompt-templates/dtos/.gitkeep`
  - `apps/server/src/modules/prompt-templates/interfaces/.gitkeep`
  - `apps/server/src/modules/prompt-templates/controllers/.gitkeep`
  - `apps/server/src/modules/prompt-templates/README.md`

##### 1.2 프롬프트 템플릿 인터페이스 및 타입 정의
- **Assignee recommendation**: Senior Backend Engineer (TypeScript 타입 시스템 전문가)
- **Priority**: P1
- **Estimated effort**: 2-3 hours
- **Description**:
  - `IPromptTemplate`, `IRoleTemplate`, `IPromptVariable` 인터페이스 정의
  - Role 타입 enum 정의 (RoleType: CTO, TechLead, AILead, InfraLead 등)
  - 버전 관리를 위한 version 필드 포함
  - 변수 치환을 위한 타입 시스템 구축
  - JSDoc으로 각 인터페이스 문서화
- **Acceptance Criteria**:
  - [ ] `interfaces/prompt-template.interface.ts` 파일 존재
  - [ ] `IPromptTemplate`, `IRoleTemplate`, `IPromptVariable` 인터페이스 정의됨
  - [ ] Role 타입이 enum 또는 union type으로 정의됨
  - [ ] 버전 관리를 위한 `version: string` 필드 포함
  - [ ] 변수 치환을 위한 `substituteVariables()` 메서드 정의
  - [ ] 모든 인터페이스에 JSDoc 주석 포함
  - [ ] Git 커밋: `feat: Add prompt template interfaces and types`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/interfaces/prompt-template.interface.ts`
  - `apps/server/src/modules/prompt-templates/interfaces/role-type.enum.ts`

##### 1.3 현재 시드 데이터에서 시스템 프롬프트 추출 및 분석
- **Assignee recommendation**: Backend Engineer (분석 및 문서화)
- **Priority**: P1
- **Estimated effort**: 3-4 hours
- **Description**:
  - `seed.ts`에서 모든 Role의 systemPrompt 추출
  - Role별 프롬프트 패턴 분석 (공통 구조, 변수, 특화 부분 식별)
  - 공통 변수 추출 (팀 이름, 조직 이름 등)
  - Role별 차이점 및 특화 내용 문서화
  - 분석 결과를 markdown으로 작성
- **Acceptance Criteria**:
  - [ ] 모든 Role의 systemPrompt가 추출되어 문서화됨
  - [ ] Role별 프롬프트 패턴이 분석되고 기록됨
  - [ ] 공통 변수와 Role 특화 변수가 식별됨
  - [ ] `docs/teams/backend-engineering/prompt-template-analysis.md` 파일 생성
  - [ ] 분석 결과에 템플릿 구현 가이드라인 포함
  - [ ] Git 커밋: `docs: Analyze system prompts from seed data`
- **Files to create**:
  - `docs/teams/backend-engineering/prompt-template-analysis.md`

##### 1.4 프롬프트 템플릿 레지스트리 서비스 구현
- **Assignee recommendation**: Senior Backend Engineer (NestJS 전문가)
- **Priority**: P1
- **Estimated effort**: 4-5 hours
- **Description**:
  - `PromptTemplateRegistry` 서비스 구현
  - 모든 Role 템플릿을 등록하고 조회하는 중앙 관리 시스템
  - Role별 템플릿 조회 메서드 (`getTemplateByRole()`)
  - 메모리 캐싱 구현 (Map 기반)
  - 템플릿 등록 메서드 (`registerTemplate()`)
  - 변수 치환 메서드 (`substituteVariables()`)
  - `@Injectable()` 데코레이터 적용
- **Acceptance Criteria**:
  - [ ] `services/prompt-template-registry.service.ts` 파일 존재
  - [ ] `@Injectable()` 데코레이터 적용
  - [ ] `getTemplateByRole(roleName: string): IPromptTemplate | null` 메서드 구현
  - [ ] `substituteVariables(roleName: string, vars: Record<string, string>): string | null` 메서드 구현
  - [ ] `registerTemplate(roleName: string, template: IRoleTemplate): void` 메서드 구현
  - [ ] 메모리 캐싱 로직 구현 (Map 기반)
  - [ ] JSDoc으로 메서드 문서화
  - [ ] Git 커밋: `feat: Implement PromptTemplateRegistry service`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/services/prompt-template-registry.service.ts`

##### 1.5 프롬프트 병합 서비스 구현
- **Assignee recommendation**: Senior Backend Engineer (TypeORM 경험)
- **Priority**: P1
- **Estimated effort**: 5-6 hours
- **Description**:
  - `PromptMergeService` 서비스 구현
  - 코드 템플릿과 DB 커스텀 프롬프트 병합 로직
  - 우선순위 규칙: DB 커스텀 > 코드 템플릿
  - `getFinalPrompt(roleId, variables)` 메서드 구현
  - `getFinalPromptForHollon(hollonId, variables)` 메서드 구현
  - 변수 치환 로직 통합
  - PromptTemplateRegistry와 Role Repository 의존성 주입
- **Acceptance Criteria**:
  - [ ] `services/prompt-merge.service.ts` 파일 존재
  - [ ] `getFinalPrompt(roleId: string, variables?: Record<string, string>): Promise<string>` 메서드 구현
  - [ ] `getFinalPromptForHollon(hollonId: string, variables?: Record<string, string>): Promise<string>` 메서드 구현
  - [ ] DB 값과 코드 템플릿 병합이 정상 작동 (DB 우선)
  - [ ] 변수 치환 로직 구현
  - [ ] Role/Hollon not found 시 NotFoundException 발생
  - [ ] Git 커밋: `feat: Implement PromptMergeService`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/services/prompt-merge.service.ts`

##### 1.6 프롬프트 템플릿 모듈 통합 및 등록
- **Assignee recommendation**: Backend Engineer (NestJS 모듈 구조 경험)
- **Priority**: P1
- **Estimated effort**: 2-3 hours
- **Description**:
  - `PromptTemplateModule` 생성
  - 모든 서비스 (Registry, Merge) providers에 등록
  - 서비스를 exports에 추가하여 다른 모듈에서 사용 가능하도록
  - `app.module.ts`에 PromptTemplateModule import
  - TypeORM forFeature로 Role/Hollon 엔티티 import
- **Acceptance Criteria**:
  - [ ] `prompt-template.module.ts` 파일 존재
  - [ ] `@Module` 데코레이터에 모든 providers 등록 (Registry, Merge)
  - [ ] exports에 PromptMergeService, PromptTemplateRegistry 포함
  - [ ] TypeORM forFeature로 Role, Hollon 엔티티 import
  - [ ] `app.module.ts`에 PromptTemplateModule import
  - [ ] 애플리케이션이 정상 실행됨 (`pnpm dev` 성공)
  - [ ] Git 커밋: `feat: Create PromptTemplateModule and integrate into AppModule`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/prompt-template.module.ts`
- **Files to modify**:
  - `apps/server/src/app.module.ts`

---

#### **Phase 2: Template Implementation**

##### 2.1 CTO Role 기본 프롬프트 템플릿 구현
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 2-3 hours
- **Description**:
  - `templates/roles/cto.template.ts` 파일 생성
  - `IRoleTemplate` 인터페이스 구현
  - seed.ts의 CTO 프롬프트를 템플릿으로 변환
  - 변수 치환 로직 구현 (`substituteVariables()`)
  - 템플릿 변수 정의 (teamName, organizationName 등)
- **Acceptance Criteria**:
  - [ ] `templates/roles/cto.template.ts` 파일 존재
  - [ ] `CTOTemplate` 클래스가 `IRoleTemplate` 구현
  - [ ] `getTemplate()` 메서드가 IPromptTemplate 반환
  - [ ] `substituteVariables()` 메서드 구현
  - [ ] 템플릿 내용이 seed.ts의 CTO 프롬프트와 일치
  - [ ] Git 커밋: `feat: Implement CTO role prompt template`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/cto.template.ts`

##### 2.2 TechLead Role 기본 프롬프트 템플릿 구현
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 2-3 hours
- **Description**:
  - `templates/roles/tech-lead.template.ts` 파일 생성
  - CTO 템플릿과 동일한 패턴 적용
  - seed.ts의 TechLead 프롬프트를 템플릿으로 변환
  - TechLead 특화 변수 정의
- **Acceptance Criteria**:
  - [ ] `templates/roles/tech-lead.template.ts` 파일 존재
  - [ ] `TechLeadTemplate` 클래스가 `IRoleTemplate` 구현
  - [ ] 템플릿 내용이 seed.ts의 TechLead 프롬프트와 일치
  - [ ] 변수 치환이 정상 작동
  - [ ] Git 커밋: `feat: Implement TechLead role prompt template`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/tech-lead.template.ts`

##### 2.3 AILead, InfraLead Role 프롬프트 템플릿 구현
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 3-4 hours
- **Description**:
  - `ai-lead.template.ts`, `infra-lead.template.ts` 파일 생성
  - AI/ML 특화 지침 (AILead) 및 인프라 특화 지침 (InfraLead) 포함
  - seed.ts의 해당 Role 프롬프트를 템플릿으로 변환
- **Acceptance Criteria**:
  - [ ] `templates/roles/ai-lead.template.ts` 파일 존재
  - [ ] `templates/roles/infra-lead.template.ts` 파일 존재
  - [ ] 각 템플릿이 `IRoleTemplate` 구현
  - [ ] 템플릿 내용이 seed.ts의 프롬프트와 일치
  - [ ] Git 커밋: `feat: Implement AILead and InfraLead role templates`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/ai-lead.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/infra-lead.template.ts`

##### 2.4 기타 Role 프롬프트 템플릿 구현 (BackendEngineer, MLEngineer, DataEngineer 등)
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 4-5 hours
- **Description**:
  - 나머지 모든 Role 템플릿 구현:
    - `backend-engineer.template.ts`
    - `ml-engineer.template.ts`
    - `data-engineer.template.ts`
    - `junior-backend-engineer.template.ts`
  - seed.ts의 각 Role 프롬프트를 템플릿으로 변환
- **Acceptance Criteria**:
  - [ ] 모든 Role에 대한 템플릿 파일 존재
  - [ ] 각 템플릿이 `IRoleTemplate` 구현
  - [ ] 템플릿 내용이 seed.ts의 프롬프트와 일치
  - [ ] Git 커밋: `feat: Implement remaining role prompt templates`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/backend-engineer.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/ml-engineer.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/data-engineer.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/junior-backend-engineer.template.ts`

##### 2.5 Specialized Sub-Hollon Role 템플릿 구현 (Planning, Implementation, Testing, Integration)
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 4-5 hours
- **Description**:
  - Specialized Role 템플릿 구현:
    - `planning-specialist.template.ts`
    - `implementation-specialist.template.ts`
    - `testing-specialist.template.ts`
    - `integration-specialist.template.ts`
  - seed.ts의 각 Role 프롬프트를 템플릿으로 변환
- **Acceptance Criteria**:
  - [ ] 4개의 Specialized Role 템플릿 파일 존재
  - [ ] 각 템플릿이 `IRoleTemplate` 구현
  - [ ] 템플릿 내용이 seed.ts의 프롬프트와 일치
  - [ ] Git 커밋: `feat: Implement specialized role templates`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/templates/roles/planning-specialist.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/implementation-specialist.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/testing-specialist.template.ts`
  - `apps/server/src/modules/prompt-templates/templates/roles/integration-specialist.template.ts`

##### 2.6 PromptTemplateRegistry에 모든 템플릿 등록
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 2 hours
- **Description**:
  - `PromptTemplateRegistry` 생성자에서 모든 템플릿 등록
  - 각 Role 템플릿 인스턴스 생성 및 `registerTemplate()` 호출
  - 등록 누락 시 에러 로깅
- **Acceptance Criteria**:
  - [ ] Registry 생성자에서 모든 템플릿 등록
  - [ ] 등록된 템플릿 개수 확인 로직 추가
  - [ ] 누락된 템플릿이 없는지 검증
  - [ ] Git 커밋: `feat: Register all role templates in PromptTemplateRegistry`
- **Files to modify**:
  - `apps/server/src/modules/prompt-templates/services/prompt-template-registry.service.ts`

---

#### **Phase 3: Service Integration & Testing**

##### 3.1 Role 서비스에서 프롬프트 템플릿 서비스 통합
- **Assignee recommendation**: Senior Backend Engineer
- **Priority**: P1
- **Estimated effort**: 3-4 hours
- **Description**:
  - `RoleService`에 `PromptMergeService` 주입
  - `getSystemPrompt(roleId, variables?)` 메서드 추가
  - 하드코딩된 프롬프트 참조 제거
  - 기존 메서드가 새 서비스 사용하도록 리팩토링
- **Acceptance Criteria**:
  - [ ] `RoleService`가 `PromptMergeService`를 주입받음
  - [ ] `getSystemPrompt(roleId: string, variables?: Record<string, string>): Promise<string>` 메서드 추가
  - [ ] 하드코딩된 systemPrompt 참조 제거
  - [ ] 기존 기능이 정상 작동 (Role 생성, 조회 등)
  - [ ] Git 커밋: `feat: Integrate PromptMergeService into RoleService`
- **Files to modify**:
  - `apps/server/src/modules/role/role.service.ts`

##### 3.2 Hollon 서비스에서 프롬프트 템플릿 서비스 통합
- **Assignee recommendation**: Senior Backend Engineer
- **Priority**: P1
- **Estimated effort**: 3-4 hours
- **Description**:
  - `HollonService`에 `PromptMergeService` 주입
  - Hollon 생성 시 systemPrompt를 null로 설정 (템플릿에서 가져옴)
  - `getSystemPrompt(hollonId)` 메서드 추가
  - Hollon 업데이트 로직 확인
- **Acceptance Criteria**:
  - [ ] `HollonService`가 `PromptMergeService`를 주입받음
  - [ ] `getSystemPrompt(hollonId: string): Promise<string>` 메서드 추가
  - [ ] Hollon 생성 시 새 서비스를 통해 프롬프트 가져옴
  - [ ] 기존 기능이 정상 작동 (Hollon 생성, 조회 등)
  - [ ] Git 커밋: `feat: Integrate PromptMergeService into HollonService`
- **Files to modify**:
  - `apps/server/src/modules/hollon/hollon.service.ts`

##### 3.3 시드 데이터에서 systemPrompt 필드 제거
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 1-2 hours
- **Description**:
  - `seed.ts`에서 모든 Role의 systemPrompt 필드를 null로 변경 또는 제거
  - 시드 실행이 정상 작동하는지 확인
  - 생성된 Role이 코드 템플릿에서 프롬프트를 가져오는지 검증
- **Acceptance Criteria**:
  - [ ] `seed.ts`에서 systemPrompt 필드가 null로 설정되거나 제거됨
  - [ ] 시드 실행이 정상 작동 (`pnpm seed` 성공)
  - [ ] 생성된 Role이 코드 템플릿에서 프롬프트를 가져옴
  - [ ] DB 마이그레이션 없이 변경사항 적용
  - [ ] Git 커밋: `refactor: Remove hardcoded systemPrompt from seed data`
- **Files to modify**:
  - `apps/server/src/database/seed.ts`

##### 3.4 단위 테스트 - 프롬프트 템플릿 서비스
- **Assignee recommendation**: QA Engineer / Backend Engineer (테스트 경험)
- **Priority**: P2
- **Estimated effort**: 5-6 hours
- **Description**:
  - `PromptTemplateRegistry` 단위 테스트 작성
  - `PromptMergeService` 단위 테스트 작성
  - 템플릿 조회, 병합, 변수 치환 등의 핵심 로직 테스트
  - 엣지 케이스 테스트 (템플릿 없음, Role 없음, 변수 누락 등)
- **Acceptance Criteria**:
  - [ ] `prompt-template-registry.service.spec.ts` 파일 존재
  - [ ] `prompt-merge.service.spec.ts` 파일 존재
  - [ ] 테스트 커버리지 80% 이상
  - [ ] 모든 핵심 로직이 테스트됨
  - [ ] 테스트가 통과 (`pnpm test`)
  - [ ] Git 커밋: `test: Add unit tests for prompt template services`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/services/prompt-template-registry.service.spec.ts`
  - `apps/server/src/modules/prompt-templates/services/prompt-merge.service.spec.ts`

##### 3.5 통합 테스트 - Role과 Hollon 프롬프트 통합
- **Assignee recommendation**: QA Engineer / Backend Engineer
- **Priority**: P2
- **Estimated effort**: 4-5 hours
- **Description**:
  - E2E 테스트 작성 (전체 플로우 검증)
  - Role 생성 → systemPrompt 조회 플로우 테스트
  - Hollon 생성 → systemPrompt 조회 플로우 테스트
  - 프롬프트 병합 로직 검증 (DB 우선)
- **Acceptance Criteria**:
  - [ ] `test/prompt-template-integration.e2e-spec.ts` 파일 존재
  - [ ] Role 생성 플로우가 테스트됨
  - [ ] Hollon 생성 플로우가 테스트됨
  - [ ] 프롬프트 병합이 정상 작동 (DB > 코드 템플릿)
  - [ ] 테스트가 통과 (`pnpm test:e2e`)
  - [ ] Git 커밋: `test: Add integration tests for prompt template system`
- **Files to create**:
  - `apps/server/test/prompt-template-integration.e2e-spec.ts`

---

#### **Phase 4: Advanced Features & Documentation**

##### 4.1 프롬프트 템플릿 DTO 정의
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 2-3 hours
- **Description**:
  - `CreatePromptTemplateDto`, `UpdatePromptTemplateDto`, `PromptTemplateResponseDto` 정의
  - class-validator 데코레이터 추가 (IsString, IsEnum, IsOptional 등)
  - 각 DTO가 해당 인터페이스를 구현하거나 확장
- **Acceptance Criteria**:
  - [ ] `dtos/` 디렉토리에 모든 필요한 DTO 정의됨
  - [ ] class-validator 데코레이터 적용
  - [ ] 각 DTO가 해당 인터페이스 구현
  - [ ] Git 커밋: `feat: Add prompt template DTOs with validation`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/dtos/create-prompt-template.dto.ts`
  - `apps/server/src/modules/prompt-templates/dtos/update-prompt-template.dto.ts`
  - `apps/server/src/modules/prompt-templates/dtos/prompt-template-response.dto.ts`

##### 4.2 프롬프트 템플릿 컨트롤러 구현
- **Assignee recommendation**: Backend Engineer
- **Priority**: P2
- **Estimated effort**: 3-4 hours
- **Description**:
  - `PromptTemplateController` 구현
  - GET `/prompt-templates/:role` 엔드포인트 (템플릿 조회)
  - GET `/prompt-templates/preview` 엔드포인트 (변수 치환 미리보기)
  - DTO 유효성 검증 적용
- **Acceptance Criteria**:
  - [ ] `controllers/prompt-template.controller.ts` 파일 존재
  - [ ] `@Controller('prompt-templates')` 데코레이터 적용
  - [ ] GET 엔드포인트들이 구현됨
  - [ ] DTO 유효성 검증이 작동
  - [ ] 응답이 PromptTemplateResponseDto 형식
  - [ ] Git 커밋: `feat: Implement PromptTemplateController with API endpoints`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/controllers/prompt-template.controller.ts`

##### 4.3 단위 테스트 - 프롬프트 템플릿 컨트롤러
- **Assignee recommendation**: QA Engineer / Backend Engineer
- **Priority**: P2
- **Estimated effort**: 3-4 hours
- **Description**:
  - `PromptTemplateController` 단위 테스트 작성
  - API 엔드포인트 테스트
  - DTO 유효성 검증 로직 테스트
  - 응답 포맷 검증
- **Acceptance Criteria**:
  - [ ] `prompt-template.controller.spec.ts` 파일 존재
  - [ ] 모든 엔드포인트가 테스트됨
  - [ ] DTO 검증 로직이 테스트됨
  - [ ] 테스트가 통과
  - [ ] Git 커밋: `test: Add unit tests for PromptTemplateController`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/controllers/prompt-template.controller.spec.ts`

##### 4.4 프롬프트 버전 관리 시스템 구현
- **Assignee recommendation**: Senior Backend Engineer
- **Priority**: P3
- **Estimated effort**: 6-8 hours
- **Description**:
  - `PromptVersionService` 구현
  - 버전 히스토리 기록 로직
  - 버전별 조회 메서드
  - 롤백 기능 구현
  - 버전 비교 기능
- **Acceptance Criteria**:
  - [ ] `PromptVersionService` 구현됨
  - [ ] 버전 히스토리가 기록됨
  - [ ] 특정 버전으로 롤백 가능
  - [ ] 버전별 조회 API 작동
  - [ ] Git 커밋: `feat: Implement prompt template version management`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/services/prompt-version.service.ts`

##### 4.5 프롬프트 템플릿 유효성 검증 로직 구현
- **Assignee recommendation**: Backend Engineer
- **Priority**: P3
- **Estimated effort**: 4-5 hours
- **Description**:
  - `PromptValidationService` 구현
  - 프롬프트 구조 검증
  - 필수 변수 누락 감지
  - 잘못된 변수 참조 감지
  - 명확한 검증 에러 메시지
- **Acceptance Criteria**:
  - [ ] `PromptValidationService` 구현됨
  - [ ] 필수 변수 누락 감지 작동
  - [ ] 잘못된 변수 참조 감지
  - [ ] 검증 에러 메시지가 명확
  - [ ] Git 커밋: `feat: Implement prompt template validation service`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/services/prompt-validation.service.ts`

##### 4.6 성능 최적화 - 프롬프트 캐싱
- **Assignee recommendation**: Senior Backend Engineer (성능 최적화 경험)
- **Priority**: P4
- **Estimated effort**: 4-5 hours
- **Description**:
  - 프롬프트 조회 성능 최적화
  - 메모리 캐시 또는 Redis 기반 캐싱
  - 캐시 무효화 전략 정의 (TTL, 수동 무효화)
  - 캐시 히트율 모니터링
- **Acceptance Criteria**:
  - [ ] 캐싱 로직 구현됨
  - [ ] 캐시 무효화 전략이 정의됨
  - [ ] 조회 성능이 개선됨
  - [ ] 캐시 히트율이 모니터링됨
  - [ ] Git 커밋: `perf: Add caching for prompt template queries`
- **Files to modify**:
  - `apps/server/src/modules/prompt-templates/services/prompt-template-registry.service.ts`

##### 4.7 프롬프트 템플릿 관리 문서 작성
- **Assignee recommendation**: Backend Engineer (문서화 경험)
- **Priority**: P3
- **Estimated effort**: 4-5 hours
- **Description**:
  - 프롬프트 템플릿 시스템 사용 방법 문서 작성
  - 아키텍처 다이어그램 포함
  - API 엔드포인트 문서화
  - 새 Role 추가 가이드
  - 변수 사용 예시
  - 커스터마이징 가이드
- **Acceptance Criteria**:
  - [ ] `docs/prompt-template-system.md` 파일 존재
  - [ ] 아키텍처 다이어그램 포함 (Mermaid 또는 이미지)
  - [ ] API 엔드포인트가 문서화됨
  - [ ] 새 Role 추가 가이드 작성
  - [ ] 변수 사용 예시 포함
  - [ ] Git 커밋: `docs: Add prompt template system documentation`
- **Files to create**:
  - `docs/prompt-template-system.md`

##### 4.8 프롬프트 템플릿 변경 로깅 및 감사
- **Assignee recommendation**: Senior Backend Engineer
- **Priority**: P4
- **Estimated effort**: 5-6 hours
- **Description**:
  - 프롬프트 템플릿 변경 이력 로깅
  - 누가, 언제, 무엇을 변경했는지 추적
  - 변경 전후 내용 저장
  - 감사 로그 조회 API 구현
- **Acceptance Criteria**:
  - [ ] 변경 이력이 DB에 저장됨
  - [ ] 사용자 정보가 기록됨
  - [ ] 변경 전후 내용이 저장됨
  - [ ] 감사 로그 조회 API 구현
  - [ ] Git 커밋: `feat: Implement audit logging for prompt template changes`
- **Files to create**:
  - `apps/server/src/modules/prompt-templates/entities/prompt-audit-log.entity.ts`
  - `apps/server/src/modules/prompt-templates/services/prompt-audit.service.ts`

##### 4.9 프로덕션 배포 및 모니터링 설정
- **Assignee recommendation**: DevOps Engineer
- **Priority**: P1
- **Estimated effort**: 3-4 hours
- **Description**:
  - 프로덕션 배포 준비
  - 배포 후 검증 스크립트 작성
  - 로그 모니터링 설정
  - 에러 알림 설정
  - 롤백 계획 준비
- **Acceptance Criteria**:
  - [ ] 프로덕션 배포 완료
  - [ ] 배포 후 검증 수행 (Role/Hollon 생성 테스트)
  - [ ] 로그 모니터링 설정
  - [ ] 에러 알림 작동
  - [ ] 롤백 계획 문서화
  - [ ] Git 커밋: `chore: Configure production deployment and monitoring`
- **Files to create**:
  - `docs/deployment/prompt-template-deployment.md`

---

### Dependencies Between Subtasks

**의존성 그래프:**

```
Phase 1 (Core Infrastructure)
  1.1 (디렉토리 구조) → 1.2, 1.3, 1.4, 1.5
  1.2 (인터페이스 정의) → 1.4, 1.5, 2.1~2.6
  1.3 (프롬프트 분석) → 2.1~2.6
  1.4 (Registry) → 1.5, 2.6
  1.5 (MergeService) → 1.6, 3.1, 3.2
  1.6 (모듈 통합) → Phase 2, Phase 3

Phase 2 (Template Implementation)
  2.1~2.5 (템플릿 구현) → 2.6
  2.6 (템플릿 등록) → Phase 3

Phase 3 (Integration & Testing)
  3.1 (Role 통합) → 3.4, 3.5
  3.2 (Hollon 통합) → 3.4, 3.5
  3.3 (Seed 수정) → 3.5
  3.4, 3.5 (테스트) → Phase 4

Phase 4 (Advanced Features)
  4.1 (DTO) → 4.2
  4.2 (Controller) → 4.3
  4.4, 4.5, 4.6, 4.7, 4.8 (독립적)
  4.9 (배포) → 모든 Phase 완료 후
```

**병렬 작업 가능:**
- Phase 1: 1.1 완료 후 1.2, 1.3 동시 진행 가능
- Phase 2: 2.1~2.5 모든 템플릿 병렬 구현 가능
- Phase 3: 3.1, 3.2 병렬 진행 가능
- Phase 4: 4.4, 4.5, 4.6, 4.7, 4.8 병렬 진행 가능

**Critical Path:**
```
1.1 → 1.2 → 1.4 → 1.5 → 1.6 → 2.1~2.5 → 2.6 → 3.1/3.2 → 3.3 → 3.5 → 4.9
```

## Success Criteria

### Functional Requirements
- [ ] 모든 Role에 대한 템플릿 파일이 존재하고 정상 작동
- [ ] DB 커스텀 프롬프트와 코드 템플릿이 올바르게 병합됨 (DB 우선)
- [ ] 변수 치환이 정확하게 작동함 ({{variableName}} → value)
- [ ] Role 및 Hollon 생성 시 systemPrompt가 템플릿에서 자동으로 가져와짐
- [ ] seed.ts에서 하드코딩된 systemPrompt가 제거됨
- [ ] 기존 기능이 모두 정상 작동 (회귀 없음)

### Technical Requirements
- [ ] PromptTemplateModule이 AppModule에 통합됨
- [ ] PromptMergeService가 RoleService와 HollonService에 통합됨
- [ ] 모든 서비스에 의존성 주입이 올바르게 적용됨
- [ ] 테스트 커버리지 80% 이상 달성
- [ ] 모든 단위 테스트 및 E2E 테스트 통과
- [ ] Lint 오류 없음 (`pnpm lint` 통과)
- [ ] Build 성공 (`pnpm build` 통과)

### Documentation Requirements
- [ ] `docs/prompt-template-system.md` 아키텍처 문서 작성 완료
- [ ] `docs/teams/backend-engineering/prompt-template-analysis.md` 분석 문서 작성 완료
- [ ] `apps/server/src/modules/prompt-templates/README.md` 모듈 사용법 문서 작성 완료
- [ ] API 엔드포인트가 문서화됨
- [ ] 새 Role 추가 가이드 작성 완료

### Performance Requirements
- [ ] 프롬프트 조회 시간 < 50ms (캐싱 적용 후)
- [ ] 메모리 사용량 증가 < 100MB (템플릿 캐싱)
- [ ] 애플리케이션 시작 시간 증가 < 500ms

### Deployment Requirements
- [ ] 프로덕션 배포 성공
- [ ] 배포 후 검증 완료 (Role/Hollon 생성 테스트)
- [ ] 로그 모니터링 설정 완료
- [ ] 에러 알림 작동 확인
- [ ] 롤백 계획 문서화 완료

---

## Implementation Notes

### Code Style Guidelines
- **TypeScript Strict Mode**: 모든 타입을 명시적으로 정의
- **NestJS Patterns**: Injectable 서비스, 의존성 주입, 모듈 구조 준수
- **Naming Conventions**:
  - 클래스: PascalCase (예: `PromptTemplateRegistry`)
  - 메서드/변수: camelCase (예: `getTemplateByRole`)
  - 상수: UPPER_SNAKE_CASE (예: `DEFAULT_VERSION`)
  - 파일명: kebab-case (예: `prompt-template.interface.ts`)
- **Error Handling**: NotFoundException, BadRequestException 사용
- **Logging**: NestJS Logger 사용, 주요 동작 로깅

### Testing Strategy
- **Unit Tests**: 각 서비스의 메서드별 테스트
- **Integration Tests**: E2E 테스트로 전체 플로우 검증
- **Mocking**: TypeORM Repository는 mock 사용
- **Coverage**: 80% 이상 목표

### Git Commit Strategy
- **Conventional Commits** 형식 준수:
  - `feat:` - 새 기능 추가
  - `fix:` - 버그 수정
  - `refactor:` - 코드 리팩토링
  - `test:` - 테스트 추가/수정
  - `docs:` - 문서화
  - `chore:` - 빌드/설정 변경
- 각 subtask는 하나의 커밋으로 완료
- 커밋 메시지는 영문으로 작성

### Rollback Plan
문제 발생 시:
1. **Phase 1~2 실패**: 모듈 제거, 기존 시스템 복원
2. **Phase 3 실패**: seed.ts 롤백, 서비스 통합 제거
3. **Phase 4 실패**: 고급 기능만 제거, 핵심 기능 유지

---

*Generated by: PlanningSpecialist*
*Date: 2026-01-08T15:59:00.132Z*
*Status: PENDING_REVIEW*
